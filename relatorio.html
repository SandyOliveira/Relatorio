<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Relatório de Aulas - Vitoria</title>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
    }
    .container {
      background: #fff;
      width: 700px;
      margin: 40px;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }
    h1, h2, h3 {
      margin: 0 0 10px 0;
    }
    h1 {
      color: #4B4BFF;
      text-align: center;
      margin-bottom: 20px;
    }
    h2 {
      color: #333;
      margin-bottom: 5px;
    }
    h3 {
      color: #555;
      margin-bottom: 15px;
    }
    .creditos {
      background: #e0f7fa;
      padding: 10px 15px;
      border-radius: 8px;
      display: inline-block;
      margin-bottom: 20px;
      font-weight: bold;
      color: #00796b;
    }
    .aula {
      background: #f1f1f1;
      padding: 15px 20px;
      margin-bottom: 12px;
      border-radius: 8px;
      transition: 0.3s;
    }
    .aula:hover {
      background: #e0e0ff;
    }
    .aula-title {
      font-weight: bold;
      color: #3f51b5;
      margin-bottom: 5px;
    }
    .aula-info {
      color: #333;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Relatório de Aulas</h1>
    <h2 id="modulo">Módulo - </h2>
    <h3 id="aluna">Aluna: </h3>
    <div class="creditos">Créditos disponíveis: <span id="creditos">0</span></div>

    <h2>Trilha de Aulas</h2>
    <div id="listaAulas"></div>
  </div>

  <script>
    // 🔹 Configuração Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyBoSaXfiu4H5OgNwBprq57zuKrgoGcQkZc",
      authDomain: "contando-69c3b.firebaseapp.com",
      projectId: "contando-69c3b",
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const params = new URLSearchParams(window.location.search);
    const alunoId = params.get("aluno") || "vitoria";

    async function carregarDados() {
      const doc = await db.collection("alunos").doc(alunoId).get();
      if (doc.exists) {
        document.getElementById("modulo").innerText = "Módulo - " + doc.data().modulo;
        document.getElementById("aluna").innerText = "Aluna: " + doc.data().nome;
        document.getElementById("creditos").innerText = doc.data().creditos;
      }
      carregarAulas();
    }

    async function carregarAulas() {
      const container = document.getElementById("listaAulas");
      container.innerHTML = "";
      const snapshot = await db.collection("alunos").doc(alunoId).collection("aulas").get();

      snapshot.forEach(aula => {
        const div = document.createElement("div");
        div.className = "aula";
        div.innerHTML = `
          <div class="aula-title">${aula.id} - ${aula.data().data} (${aula.data().horario})</div>
          <div class="aula-info">${aula.data().conteudo}</div>
        `;
        container.appendChild(div);
      });
    }

    carregarDados();
  </script>
</body>
</html>
